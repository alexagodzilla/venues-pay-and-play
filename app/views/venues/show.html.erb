<div class="container">
  <h2 class="mt-4 mb-4"><%= @venue.name %></h2>
  <div class="container-fluid my-4 shadow-sm">
    <% if @venue.photo.attached? %>
      <%= cl_image_tag(@venue.photo.key, width: 287, height: 150, crop: :thumb, gravity: :face, radius: 5) %>
      <div class="container my-4">
        <p><i class="fa-solid fa-tag me-3"></i> £<%= @venue.price_per_day %> per day</p>
  <p><i class="fa-solid fa-location-dot me-3"></i> <%= @venue.location%></p>
  <p><i class="fa-solid fa-users me-2"></i> Up to <%= @venue.size_of_band %></i></p>
  <p><i class="fa-solid fa-circle-info me-3"></i><%= @venue.description %></p>
  <button class="btn btn-success my-2 shadow-lg" type="submit">
    <%= link_to "Book venue", new_venue_booking_path(@venue), class: "text-white" %>
  </button>
  <% if @venue.user == current_user %>
    <button class="btn btn-warning my-2 shadow-lg" type="submit">
      <%= link_to "Edit venue", edit_venue_path(@venue), class: "text-white" %>
    </button>
  <% end %>
  <% if @venue.user == current_user %>
    <button class="btn btn-danger my-2 shadow-lg" type="submit">
      <%= link_to "Delete venue", venue_path(@venue), data: { turbo_method: :delete,
      turbo_confirm: "Are you sure you want to delete your venue?" }, class: "text-white" %>
    </button>
  <% end %>
    </div>
    <% else %>
       <%= image_tag(@venue.pic_url, width: 287, height: 150, crop: :thumb, gravity: :face, radius: 5) %>
       <div class="container my-4">
         <p><i class="fa-solid fa-tag me-3"></i> £<%= @venue.price_per_day %> per day</p>
  <p><i class="fa-solid fa-location-dot me-3"></i> <%= @venue.location%></p>
  <p><i class="fa-solid fa-users me-2"></i> Up to <%= @venue.size_of_band %></i></p>
  <p><i class="fa-solid fa-circle-info me-3"></i><%= @venue.description %></p>
    <button class="btn btn-success my-2 shadow-lg" type="submit">
    <%= link_to "Book venue", new_venue_booking_path(@venue), class: "text-white" %>
  </button>
  <% if @venue.user == current_user %>
    <button class="btn btn-warning my-2 shadow-lg" type="submit">
      <%= link_to "Edit venue", edit_venue_path(@venue), class: "text-white" %>
    </button>
  <% end %>
  <% if @venue.user == current_user %>
    <button class="btn btn-danger my-2 shadow-lg" type="submit">
      <%= link_to "Delete venue", venue_path(@venue), data: { turbo_method: :delete,
      turbo_confirm: "Are you sure you want to delete your venue?" }, class: "text-white" %>
    </button>
  <% end %>
  </div>
    <% end %>
  </div>
  <button class="btn btn-primary my-2 shadow-lg" type="submit">
    <%= link_to "Back to all venues", root_path, class: "text-white" %>
  </button>
<div class="container-fluid shadow-sm">
  <div class="my-4" id="map" style="width: 100%; height: 200px;"
    data-controller="map"
    data-map-markers-value="<%= @marker.to_json %>"
    data-map-api-key-value="<%= ENV.fetch('MAPBOX_API_KEY') %>">
  </div>
  </div>
<% if @venue.reviews.present? %>
  <div class="accordion mt-8" id="accordionExample">
    <div class="accordion-item">
      <h2 class="accordion-header" id="headingOne">
        <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
          Reviews
        </button>
      </h2>
      <div id="collapseOne" class="accordion-collapse collapse show" aria-labelledby="headingOne" data-bs-parent="#accordionExample">
        <div class="accordion-body">
          <% @venue.reviews.each do |review| %>
            <div class="mb-3">
              <% x = review.rating %>
              <% x.times do %>
                <strong>⭐</strong>
              <% end %>
              <p><%= review.comment %></p>
              <% if current_user == review.booking.user %>
                <button class="btn btn-danger mt-2 shadow-lg" type="submit">
                  <%= link_to "Delete Review", review_path(review), data: { turbo_method: :delete, turbo_confirm: "Are you sure you want to delete your review?" }, class: "text-white" %>
                </button>
              <% end %>
            </div>
          <% end %>
        </div>
      </div>
    </div>
  </div>
<% else %>
  <p>There are currently no reviews for this venue.</p>
<% end %>
</div>
